<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">

<head>
    <title></title>
    <meta charset="utf-8">
    <meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="../build/css/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="../build/css/ui-box.css">
    <link rel="stylesheet" href="../build/css/ui-base.css">
    <link rel="stylesheet" href="../build/css/ui-color.css">
    <link rel="stylesheet" href="../build/css/appcan.icon.css">
    <link rel="stylesheet" href="../build/css/appcan.control.css">
    <link rel="stylesheet" type="text/css" href="../build/css/order.css" />
    <link rel="stylesheet" href="../intention/css/intention.css">
    <style>
        .list-content {
            font-size: 1em;
        }
    </style>
</head>

<body id="nodata" class="bc-bg ub-f1 tx-l umar-t content-info" ontouchstart>
    <div id="content" class="fs08">

    </div>
    <div id="more"></div>

</body>
<script type="text/html" charset="utf-8" id="html">
    {{each list}}

    <div id=list{{$index}} class='list-content white-bg'>
        <div id="orderlist{{$index}}">
            <!-- 订单编号 -->
            <div class='ub ub-ac umar-l umar-r m-row3'>

                <div>
                    <span class='gray-font'>油品名称 &nbsp;&nbsp; </span>
                    <span class='AllPrice'> {{$value.OILINFO_NAME}} </span>
                </div>

            </div>
        </div>
        <div class='ub ub-ac umar-l umar-r m-row3'>
                <span class='gray-font'>客存余量 &nbsp;&nbsp;  </span>
                <span class='AllPrice'> {{$value.kecun}} </span>
                <span class="gray-font mf-size2">/吨</span>
            </div>
        <div class='ub ub-ac umar-l umar-r m-row3'>
            <span class='gray-font'>操作 &nbsp;&nbsp;  </span>
            <span data-oilinfoId={{$value.OILINFO_ID}} class='y-font umar-l' onclick="viewDetails(this.dataset)">查看明细</span>
    </div>
      
<!-- 
        <div class='ub ub-ac umar-l umar-r m-row3'>
            <div id='' class='col-left'>
                <span class='gray-font'>可下计划量 </span>
                <span class='AllPrice'> {{$value.kexiajihualiang}} </span>
                <span class="gray-font mf-size2">/吨</span>
            </div>
            <div class='col-right'>
                <span class='gray-font'>已购未提量 </span>
                <span class='AllPrice'> {{$value.yigouweiti}} </span>
                <span class="gray-font mf-size2">/吨</span>

                </span>
            </div>
        </div> -->
    </div>
    </div>
    <div class='gap'></div>
    {{/each}}
</script>
</body>

<script src="../build/js/appcan.js"></script>
<script src="../build/js/appcan.control.js"></script>
<script src="../common/template-web.js" type="text/javascript" charset="utf-8"></script>
<script src="../common/common.js"></script>
<script src="../common/jquery.min.js"></script>

<script>
    template.defaults.imports.changeMoney = function (value) {
        return fmoney(value)
    }
    template.defaults.imports.OneDecimal = function (number) {
        return number.toFixed(1);
    }
    // 当所有组件准备好后执行内部回调方法
    appcan.ready(function () {
        mentionOil.init();
    });

    var mentionOil = {
        init: function () {
            var yue = this;
            yue.queryMentOilOrder();
        },
        queryMentOilOrder: function () {
            var orgId = appcan.locStorage.getVal("orgId")
            var yue = this;
            var paramJsonStr = "";
            var func = yue.showOrderCallback.bind(yue);

            ajaxPostQuery(URL + "/app/oil/kecun/queryKecunList", paramJsonStr, func, "text");
            appcan.window.openToast('加载中...', '0', '5', '1');
        },
        showOrderCallback: function (data) {
            appcan.window.closeToast();

            if (data === "") {
                nodata('content', '您没有客存数据可以查看！');
                return;
            }
            if (typeof data === "string" && data != "") {
                var data = JSON.parse(data);
            }

            var totalCount = data.rows;

            if (totalCount === undefined || data===""|| totalCount.length == 0) {
                nodata('content', '您没有客存数据可以查看！')
                return;
            } else {
                var html = template('html', {
                    list: data.rows
                })

                $('#content').append(html);
                document.querySelector("#content .gap:last-child").remove();


            }
        }
    }


    function viewDetails(data) {
        appcan.locStorage.setVal("OILINFO_ID", data.oilinfoid);
        appcan.window.open("detail", "kecun_detail.html", 10);
    }

   
</script>

</html>