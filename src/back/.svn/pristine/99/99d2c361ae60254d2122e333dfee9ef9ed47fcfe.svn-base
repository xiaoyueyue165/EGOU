<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">

<head>
  <title></title>
  <meta charset="utf-8">
  <meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
  <link rel="stylesheet" href="../build/css/fonts/font-awesome.min.css">
  <link rel="stylesheet" href="../build/css/ui-box.css">
  <link rel="stylesheet" href="../build/css/ui-base.css">
  <link rel="stylesheet" href="../build/css/ui-color.css">
  <link rel="stylesheet" href="../build/css/appcan.icon.css">
  <link rel="stylesheet" href="../build/css/appcan.control.css">
  <link rel="stylesheet" href="../intention/css/intention.css" />
  <style>
    #cusCompany,
    #cusCompany1,
    #cusCompany2 {
      width: 7em;
      border: 0;
      outline: 0;
      -webkit-appearance: none;
      font: 1.2em;
      background-color: transparent;
    }
  </style>
</head>

<body class="pop-body" ontouchstart>

  <div class="pop-wrapper">
    <div class="pop-content">
      <form id="formData">
        <div class="pop-info">
          <label for="cusName">销售公司：</label>

          <select id="gyfgsSelect" name="gyfgs" class="mySelect"></select>

        </div>
        <div class="pop-info">
          <label for="cusName">客户名称：</label>
          <input type="text" id="cusCompany" name="cusCompany" placeholder="请输入客户名称" />
        </div>
        <div class="pop-info">
          <label for="cusName">订单编号：</label>
          <input type="text" id="cusCompany2" name="ordersaleCode" placeholder="请输入订单编号" />
        </div>
      </form>

      <div id="btn" class="ub ub-ac">
        <div id="confirmBtn" class="uinn5 ubt ubr bc-border ub ub-f1 ub-pc">
          <span class="bc-color">查询</span>
        </div>
        <div id="cancelBtn" class="uinn5 ubt bc-border ub ub-f1 ub-pc">
          <span class="bc-color">关闭</span>
        </div>
      </div>
    </div>
  </div>
</body>

<script src="../build/js/appcan.js"></script>
<script src="../build/js/appcan.control.js"></script>
<script src="../common/common.js"></script>
<script src="../common/jquery.min.js"></script>
<script src="../common/template-web.js"></script>
<script id="gyfgs" type="text/html">

  {{each list}}
  <option value={{$value.orgId}}>{{$value.orgNameEasy ||orgName}}</option>
  {{/each}}

</script>

<script>
  var SelectData = {
    "gyfgs": []
  }
  getGYFGS();

  appcan.ready(function () {
    appcan.initBounce();
    // 销售公司=》购油分公司
    var html1 = template('gyfgs', {
      list: SelectData.gyfgs
    })

    $("#gyfgsSelect").html(html1);
    $("#gyfgsSelect").prepend("<option value=''>请选择</option>");
  })


  function getGYFGS() {
    var paramJsonStr = "&pager.pageNo=" + pageNo + "&pager.pageSize=" + 100;
    var func = GYFGS;
    syncLoadData(URL + "/backgrd/bilOutstorePlan/selectERPCompany", paramJsonStr, func);
  }

  function GYFGS(data) {
    SelectData.gyfgs = JSON.parse(data);
  }

  appcan.button("#confirmBtn", "act-ani", function () {

    var type = appcan.locStorage.getVal("searchType");
    switch (type) {
      case "tihuodan":
        var paramJsonStr = serialize(document.getElementById(
          "formData")) + "&pager.pageNo=" + pageNo + "&pager.pageSize=" + pageSize;
        var func = showOrderCallback;

        ajaxPostQuery(URL + "/backgrd/newBilSend/getSendAndOutStoreList", paramJsonStr, func, "text");
        break;
      case "chukudan":
        var paramJsonStr = serialize(document.getElementById(
          "formData")) + "&pager.pageNo=" + pageNo + "&pager.pageSize=" + pageSize + "&outAgoFlag=outAgoFlag";
        var func = showOrderCallback2;

        ajaxPostQuery(URL + "/backgrd/newBilSend/getSendAndOutStoreList", paramJsonStr, func, "text");

      default:
        break;
    }

    appcan.window.openToast('加载中...', '0', '5', '1');
  })

  function showOrderCallback(data) {
    setTimeout(function () {
      closeToast();
      if (typeof data === "string" && data != '') {
        var result = JSON.parse(data);
        var rows = result.rows;
        if (rows && rows.length > 0) {
          var obj = {
            "type": "tihuodan",
            "data": rows
          }

          appcan.locStorage.setVal("searchData", obj)

        } else {
          appcan.locStorage.setVal("searchData", 0);
        }
      } else {
        appcan.locStorage.setVal("searchData", 0)
      }
      appcan.window.publish("search", "true");
      closepop();
    }, 1000);
  }

  function showOrderCallback2(data) {
    setTimeout(function () {
      closeToast();
      if (typeof data === "string" && data != '') {
        var result = JSON.parse(data);
        var rows = result.rows;
        if (rows && rows.length > 0) {
          var obj = {
            "type": "chukudan",
            "data": rows
          }

          appcan.locStorage.setVal("searchData", obj)

        } else {
          appcan.locStorage.setVal("searchData", 0);
        }
      } else {
        appcan.locStorage.setVal("searchData", 0)
      }
      appcan.window.publish("search", "true");
      closepop();
    }, 1000);
  }

  appcan.button("#cancelBtn", "act-ani", function () {
    closepop();
  })

  //关闭浮动窗口
  function closepop() {
    appcan.closePopover("searchByCus");
  }
</script>

</html>