<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">
<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">

<head>
  <title></title>
  <meta charset="utf-8" />
  <meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
  <link rel="stylesheet" href="../build/css/fonts/font-awesome.min.css" />
  <link rel="stylesheet" href="../build/css/ui-box.css" />
  <link rel="stylesheet" href="../build/css/ui-base.css" />
  <link rel="stylesheet" href="../build/css/ui-color.css" />
  <link rel="stylesheet" href="../build/css/appcan.icon.css" />
  <link rel="stylesheet" href="../build/css/appcan.control.css" />
  <link rel="stylesheet" type="text/css" href="css/quickbuy.css" />
  <link rel="stylesheet" type="text/css" href="../common/css/yue.css" />
  <link rel="stylesheet" href="../userpage/css/userpage.css">
  <link rel="stylesheet" type="text/css" href="./css/quickbuy.css" />
  <style type="text/css">
    #infoList {
      width: 100%;
      background-color: #fff;
      overflow-y: scroll;
    }
  </style>
</head>

<body class="um-vp " ontouchstart>
  <div id="page_0" class="up ub ub-ver bc-bg" tabindex="0">

    <!--header开始-->
    <div id="header" class="uh bc-text-head ub bc-head">
      <div class="nav-btn" id="nav-left">
        <div class="t-btn-a1 ub-img uwh-tBtn fa fa-angle-left fa-2x"></div>
      </div>
      <h1 class="ut ub-f1 ulev-3 ut-s tx-c" tabindex="0">请选择合同油品</h1>
      <div class="nav-btn nav-bt" id="nav-right">
      </div>
    </div>
    <!--header结束-->

    <!--content开始-->

    <div id="content" class="ub-f1 tx-l">

      <div id="listview" class="ubt bc-border sc-bg mf-size1"></div>

      <div id="infoList">

      </div>
      <div class="uhide btn ub ub-ac ub-pc bc-text-head bc-btn uc-a1 mp-btn" id="submit" onclick="subChoose();" style="margin:1em 0.4em">
        提交
      </div>

    </div>
    <!--content结束-->
  </div>
  <script src="../build/js/appcan.js"></script>
  <script src="../build/js/appcan.control.js"></script>
  <script src="../build/js/appcan.listview.js"></script>
  <script type="text/javascript" charset="utf-8" src="../common/comm.js"></script>
</body>
<script>
  appcan.ready(function () {
    //去除滚动条
    uexWindow.setWindowScrollbarVisible('false');
    var titHeight = $('#header').offset().height;
    window.onorientationchange = window.onresize = function () {
      appcan.frame.resize("content", 0, titHeight);
    }
    queryHetongList();
    appcan.button("#nav-left", "btn-act", function () {
      appcan.window.close(-1);
    })
    appcan.button("#nav-right", "btn-act", function () {})
  });

  function queryHetongList() {
    var cusId = appcan.locStorage.getVal("cusId"),
      url = URL + '/front/oilPrice/object/queryHetongList',
      paramJsonStr = "cusId=" + cusId,
      func = loadHeTongList,
      dataType = "text";
    ajaxPostQueryDNnotVerifySid(url, paramJsonStr, func, dataType);
    appcan.window.openToast('加载中...', '0', '5', '1');
  }

  function showUserList(data) {
    if (typeof data == "string") {
      var data = JSON.parse(data);
    }
    var pList = data.pojoList;

    var str = "<br/>";

    for (var i = 1; i <= pList.length; i++) {
      var oilinfoId = pList[i - 1].oilinfoId;
      var oilinfoName = pList[i - 1].oilinfoName;
      var salesPrice = pList[i - 1].salesPrice;
      var psfs = pList[i - 1].shfs;
      var ysfs = pList[i - 1].ysfs;

      if (i - 1 == 0) {
        str += '<p class="userlist" ><input title="' + oilinfoName + '" id="' + salesPrice +
          '" class="userRadio" type="radio"  name="radioStation" checked="checked" value="' + oilinfoId + '"/>' +
          oilinfoName + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + psfs + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' +
          '' + ysfs + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;价格：￥<span>' + salesPrice + '</span></p>';
      } else {
        str += '<p class="userlist" ><input title="' + oilinfoName + '" id="' + salesPrice +
          '" class="userRadio" type="radio"  name="radioStation" value="' + oilinfoId + '"/>' +
          oilinfoName + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + psfs + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' +
          '' + ysfs + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;价格：￥<span>' + salesPrice + '</span></p>';
      }
    }
    $("#HetongList").html(str);

  }

  function loadHeTongList(data) {
    appcan.window.closeToast();
    if (typeof data == "string") {
      data = JSON.parse(data)
    }
    var pList = data.pojoList,
      str = "";
    if (!pList || pList.length == 0) {
      var listhtml = "<div id='time' class='ub ub-pc' style='margin: 0.8em 0;'>" +
        "<span class='mf-size2 time'>暂无合同购油单</span>" + "</div>";
      $("#content").append(listhtml);
      return;
    }
    for (var i = 1; i <= pList.length; i++) {
      var oilinfoName = pList[i - 1].oilinfoName;
      var cusId = pList[i - 1].cusId;
      var oilinfoId = pList[i - 1].oilinfoId;
      var oilinfoName = pList[i - 1].oilinfoName;
      var salesPrice = pList[i - 1].salesPrice;
      var psfs = pList[i - 1].shfs;
      var ysfs = pList[i - 1].ysfs;
      // (oilinfoId, oilPrice, pickupDiscount, oilinfoName)
        str += '<div class="ubb ub bc-border bc-text ub-ac lis">' +
          '<div class="radiobox umar-r" name=""><input  id="radio_' + i +
          '" type="radio" class="uabs ub-con" name="radioStation" data-oilinfoId="'+ oilinfoId +'" data-salesPrice="'+ salesPrice +'"  value="' +
          oilinfoName + '">' + '</div>' + '<div class="ub ub-pj" style="width:88%">' + '<div style="width:66%">'+ oilinfoName+'</div>'+'<div style="width:33%";float:right>'+ salesPrice+'</div>'+'</div></div>';
    }
    $("#infoList").html(str);
    var headerHeight = $("#header")[0].clientHeight;
    var height = (window.innerHeight - headerHeight) * 0.8 + 'px';
    $("#infoList").css("height", height);
    document.getElementById("submit").classList.remove("uhide");
  }

  function subChoose() {
    //数据
    var chkObjs = document.getElementsByName("radioStation");
    var cusID = "";
    for (var i = 0; i < chkObjs.length; i++) {
      if (chkObjs[i].checked) {
        var target = chkObjs[i];
        var arr = [$(target).data("oilinfoid"),String($(target).data("salesprice")),"0",target.value];
        var str = JSON.stringify(arr);
        appcan.locStorage.setVal('oilObj', str);
      }
    }
     appcan.window.open("buyOil","buyOil.html", 10);
  }

</script>

</html>