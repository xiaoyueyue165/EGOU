<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">

<head>
    <title></title>
    <meta charset="utf-8">
    <meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="../build/css/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="../build/css/ui-box.css">
    <link rel="stylesheet" href="../build/css/ui-base.css">
    <link rel="stylesheet" href="../build/css/ui-color.css">
    <link rel="stylesheet" href="../build/css/appcan.control.css">
    <link rel="stylesheet" href="css/common_page.css" />
</head>

<body class="pop-body" ontouchstart>

    <div class="pop-wrapper">
        <div class="pop-content">
            <div class="pop-info">
                <textarea placeholder="请输入取消订单的理由" class="m-textarea" oninput="reasonChange()" onpropertychange="reasonChange()"></textarea>
            </div>

            <div id="btn" class="ub ub-ac">
                <div id="confirmBtn" class="uinn5 ubt ubr bc-border ub ub-f1 ub-pc">
                    <span class="mf-color">确认</span>
                </div>
                <div id="cancelBtn" class="uinn5 ubt bc-border ub ub-f1 ub-pc">
                    <span class="mf-color">关闭</span>
                </div>
            </div>
        </div>
    </div>

    <script src="../build/js/appcan.js"></script>
    <script src="../build/js/appcan.control.js"></script>
    <script src="../common/comm.js"></script>
</body>
<script>
    appcan.ready(function () {
        appcan.initBounce();
    })

    function reasonChange() {
        var reason = $("textarea")[0].value;
    }

    appcan.button("#confirmBtn", "act-ani", function () {
        var orderId = appcan.locStorage.getVal("cancelReasonID");
        appcan.locStorage.remove("cancelReasonID");
        var remark = $("textarea")[0].value;

        var url = URL + "/app/bill/cancelOrder";
        var paramJsonStr = "orderId=" + orderId + "&remark=" + remark;
        var func = cancelOrderCallBack;
        var dataType = "text";
        ajaxPostQuery(url, paramJsonStr, func, dataType);
        appcan.window.openToast('请稍后...', '0', '5', '1');
    })

    function cancelOrderCallBack(data) {
        appcan.window.closeToast();
        if (data == "ok") {
            appcan.window.publish('cancelYXD', true);
            closepop();
        } else {
            uexWindow.alert("提示", "意向单取消失败", "确定");
        }
    }

    appcan.button("#cancelBtn", "act-ani", function () {
        closepop();
    })

    //关闭浮动窗口
    function closepop() {
        appcan.closePopover("cancelReason");
    }
</script>

</html>