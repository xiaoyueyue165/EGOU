<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">

<head>
    <title></title>
    <meta charset="utf-8">
    <meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="build/css/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="build/css/ui-box.css">
    <link rel="stylesheet" href="build/css/ui-base.css">
    <link rel="stylesheet" href="build/css/ui-color.css">
    <link rel="stylesheet" href="build/css/appcan.icon.css">
    <link rel="stylesheet" href="build/css/appcan.control.css">
    <link rel="stylesheet" href="index/page1/index.css" />

</head>

<body class="um-vp bc-bg" ontouchstart>
    <div id="page_0" class="up ub ub-ver bc-bg" tabindex="0">

        <div id="content" class=" ub-f1 ub ub-ver">

            <div class="ub ub-ver ub-f1">

                <div id="label" class="float-bar-wrapper ub ub-pj">
                    <div id="notice_main" class="ub ub-pj float-bar">
                        <ul style="height:1em"></ul>
                    </div>
                    <div id="remove" class="fa fa-close ub ub-ac umar-r"></div>
                </div>

                <div class="ub-f1 ub">
                    <div id="0" class="uw-app1 c-blue-01 ub ub-ac">
                        <div class="bc-text-head ulev-me1 ub-f1 icon-index  icon_search">
                            快速查询
                        </div>
                    </div>
                    <div id="1" class="uw-app1 c-blue-02 ub ub-ac">
                        <div class="bc-text-head ulev-me1 ub-f1 icon-index icon-price">
                            提油二维码
                        </div>
                    </div>
                </div>
                <div class="ub-f1 ub">
                    <div id="2" class="uw-app1 c-blue-03 ub ub-ac">
                        <div class="bc-text-head ulev-me1 ub-f1 icon-index icon_purchase">
                            我要买油
                        </div>
                    </div>
                    <div id="3" class="uw-app1 c-blue-04 ub ub-ac">
                        <div class="bc-text-head ulev-me1 ub-f1 icon-index icon_delivery">
                            我要提油
                        </div>
                    </div>
                </div>
                <div class="ub-f1 ub">
                    <div id="4" class="uw-app1 c-blue-05 ub ub-ac">
                        <div class="bc-text-head ulev-me1 ub-f1 icon-index icon-location">
                            配送跟踪
                        </div>
                    </div>
                    <div id="5" class="uw-app1 c-blue-06 ub ub-ac">
                        <div class="bc-text-head ulev-me1 ub-f1 icon-index icon_news">
                            资讯中心
                        </div>
                    </div>
                </div>
            </div>
            <!--分类结束-->
        </div>
        <!--content结束-->
    </div>

</body>
<script src="build/js/appcan.js"></script>
<script src="build/js/appcan.control.js"></script>
<script src="common/comm.js"></script>
<script src="common/jquery.min.js"></script>
<script>
    var noticeContent = {};
    appcan.ready(function () {
        appcan.window.disableBounce()
        page1.init();
    })
    var page1 = {
        init: function () {
            var yue = this;
            // yue.selectContInfoListBy();
            yue.options().bind();

        },
        options: function () {
            var yue = this;
            yue.options = {};
            yue.options.close = document.getElementById('remove');

            yue.options.sixLogo = document.getElementsByClassName('uw-app1');

            return this;

        },

        bind: function () {
            var yue = this;
            tap(yue.options.close, function () {
                $("#label").remove();
            })
            var ArrLogo = Array.prototype.slice.call(yue.options.sixLogo);
            ArrLogo.forEach(function (v, index) {
                v.onclick = function (event) {
                    yue.openPage(event, index)

                }
            })

        },
        selectContInfoListBy: function () {
            // 获取通知公告
            var paramJsonStr = "isStop=0&cont_type=1&pager.pageSize=15&pager.pageNo=1";
            ajaxPostQuery(URL + "/comm/continfo/selectContInfoListBy", paramJsonStr,
                selectContInfoListByCallBack, "text")
        },
        openPage: function (event, id) {
            // 获取App的版本号
            getAppVersion();

            uexWindow.setPopoverFrame("pricescan", 0, 0, $("#content").width(), $("#content").height());

            var userType = appcan.locStorage.getVal('userType');
            // 权限控制
            var cusAuthority = appcan.locStorage.getVal('cusAuthority');
            var quanxianArr = cusAuthority ? cusAuthority.split(',') : [];
            // 买油权限 0 
            // 提油权限 1
            // 查询权限 2
            // 司机权限 3

            console.log(quanxianArr);
            var currentId = id.toString();

            if (currentId === "0" && isContains(quanxianArr, "2")) {
                appcan.window.open("search", "quickSearch/quickSearch.html", 10, 0);
            } else if (currentId === "2" && isContains(quanxianArr, "0")) {
                appcan.window.open("quickbuy", "buyOil/buyOil.html", 10, 0);
            } else if (currentId === "3" && isContains(quanxianArr, "1")) {
                appcan.window.open("pickup", "mentionOil/mentionOil.html", 10, 0);
            } else if (currentId === "1" && isContains(quanxianArr, "3")) {
                appcan.locStorage.setVal('QRCode', 'true');
                appcan.window.open("QRCcode", "QRCode/ordermgmtList.html", 10, 0);
            }
            switch (currentId) {
                case "4":
                    appcan.window.open("track", "deliveryTracking/deliveryTracking.html", 10, 0);
                    break;
                case "5":
                    appcan.window.open("zixun", "zixun/zixun.html", 10, 0);
                    break;
            }
        }
    }

    //获取通知公告数据回调
    function selectContInfoListByCallBack(data) {
        var a = data;
        if (typeof data == "string") {
            data = JSON.parse(data)
        }
        if (data.rows.length > 0) {
            for (var i = 0; i < data.rows.length; i++) {
                var creatDate = data.rows[i].create_date;
                noticeContent[data.rows[i].cont_info] = data.rows[i].cont_info;
                noticeContent["con" + data.rows[i].CONT_ID] = data.rows[i].cont_title;
                var date = creatDate.substring(5, 7) + "." + creatDate.substring(8, 10);
                var cname = "mf-size2";
                if (i > 0) {
                    cname = "mf-size2 uhide";
                }
                var lihtml = '<li id="' + data.rows[i].CONT_ID + '" class="' + cname +
                    '" onclick="openContent(id)"><span class="umar-r">' + data.rows[i].cont_title +
                    '</span><span class="umar-l">' + date + '</span></li>';
                $("ul").append(lihtml);
            };
            setInterval('scroll_news()', 10000);
        }
    }

    function scroll_news() {
        $(function () {
            $('#notice_main li').eq(0).fadeOut('slow', function () {
                //   alert($(this).clone().html());
                //克隆:不用克隆的话，remove()就没了。
                $('#notice_main li').eq(0).addClass("uhide");
                $(this).clone().appendTo($(this).parent()).fadeIn('slow');
                $(this).remove();
                $('#notice_main li').eq(0).removeClass("uhide");
            });
        });
    }

    function openContent(id) {
        var con = noticeContent[id];
        var con_title = noticeContent["con" + id];
        appcan.locStorage.setVal("noticeContent", con);
        appcan.locStorage.setVal("noticeContent_title", con_title);
        appcan.locStorage.setVal("cont_id", id);

    }
</script>

</html>