<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">

<head>
    <title></title>
    <meta charset="utf-8">
    <meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="../build/css/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="../build/css/ui-box.css">
    <link rel="stylesheet" href="../build/css/ui-base.css">
    <link rel="stylesheet" href="../build/css/ui-color.css">
    <link rel="stylesheet" href="../build/css/appcan.icon.css">
    <link rel="stylesheet" href="../build/css/appcan.control.css">
    <link rel="stylesheet" type="text/css" href="css/delivery.css" />
</head>

<body class="um-vp white-bg" ontouchstart>
    <div id="page_0" class="up ub ub-ver" tabindex="0">
        <!--header开始-->
        <div class="uh bc-text-head ub bc-head" id="header">
            <div class="nav-btn" id="nav-left">
                <div class="t-btn-a1 ub-img uwh-tBtn fa fa-angle-left fa-2x"></div>
            </div>
            <h1 class="ut ub-f1 ulev-3 ut-s tx-c" tabindex="0">押运员</h1>
            <div class="nav-btn nav-bt" id="nav-right">
                <div id="search" class="umar-r myicon myicon-search"></div>
            </div>
        </div>
        <!--header结束-->
        <!--content开始-->
        <div id="content" class="ub-f1 tx-l">
            <div id="listview" class="ubt bc-border sc-bg"></div>

        </div>
        <!--content结束-->

    </div>
    <script src="../build/js/appcan.js"></script>
    <script src="../build/js/appcan.control.js"></script>
    <script src="../build/js/appcan.listview.js"></script>
    <script src="../common/comm.js"></script>
</body>
<script>
    var yayunParam = {};
    var currentYaYun = null;
    var lv = appcan.listview({
        selector: "#listview",
        type: "thickLine",
        hasAngle: false,
        hasSubTitle: true,
        multiLine: 1,
    });
    lv.set();
    lv.on("click", function (ele, obj, curEle) {
        yayunParam = {
            title: obj.title,
            id: obj.id
        };
        $("span").remove(".fa-check");
        ele.append("<span class='fa fa-check y-font'></span>");
        $('#listview span').not(ele.find("span")).removeClass('fa fa-check');
    })
    appcan.ready(function () {
        appcan.window.subscribe("getSearchData", function (getSearchData) {
            if (getSearchData == "true") {
                var obj = JSON.parse(getVal("searchData"));
                if (obj.type === "yayun") {
                    currentYaYun = obj.data;
                    showYaYunList();
                }
            }
        })
        showYaYunList();


        appcan.button("#nav-right", "btn-act", function () {

            // uexWindow.evaluateScript("intentionList", 0, "opencancelReason()");
            // 查询押运员
            var mock = {
                type: "yayun",
                json: {
                    "text": '押运员名称',
                    "url": URL + '/app/cus/driver/queryCusDriver',
                    "param": 'temp=0'
                }
            }

            setVal("searchData", mock);
            openPopPage("searchTpl");
        })

    })


    function showYaYunList() {
        var driverlist = [];
        var listInfo = currentYaYun || getVal("yayunlist");

        if (typeof listInfo == "string") {
            listInfo = eval("(" + listInfo + ")");
        }

        for (var i = 0; i < listInfo.length; i++) {
            var name = listInfo[i].driverName;
            if (typeof (name) == "undefined") {
                name = "";
            }
            var code = listInfo[i].driverCode;
            if (typeof (code) == "undefined") {
                code = "";
            }
            var phone = listInfo[i].driverOfficephone;
            if (typeof (phone) == "undefined") {
                phone = "";
            }
            var mobile = listInfo[i].driverMobile;
            if (typeof (mobile) == "undefined") {
                mobile = "";
            }
            var id = listInfo[i].driverId;
            var param = {
                title: name,
                describe: "<div class='m-lineheight gray-font'><div>驾驶证号:" + code + "</div><div>联系方式：" +
                    mobile + "</div></div>",
                id: id
            }
            driverlist.push(param);
        };
        lv.set(driverlist);
    }
    appcan.button("#nav-left", "btn-act", function () {
        appcan.window.publish("yayunParam", yayunParam);
        appcan.window.close(-1);
    });

    function getNewYaYunData() {
        console.log('................................');

    }
</script>

</html>