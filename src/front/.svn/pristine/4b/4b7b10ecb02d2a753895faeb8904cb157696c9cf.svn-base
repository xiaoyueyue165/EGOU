<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">

<head>
    <title></title>
    <meta charset="utf-8">
    <meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="../build/css/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="../build/css/ui-box.css">
    <link rel="stylesheet" href="../build/css/ui-base.css">
    <link rel="stylesheet" href="../build/css/ui-color.css">
    <link rel="stylesheet" href="../build/css/appcan.icon.css">
    <link rel="stylesheet" href="../build/css/appcan.control.css">
    <link rel="stylesheet" type="text/css" href="../ordermgmt/css/ordermgmt.css" />
    <link rel="stylesheet" type="text/css" href="css/delivery.css" />

</head>

<body id="nodata" class="bc-bg ub-f1 tx-l umar-t content-info" ontouchstart>
    <div id="content">

    </div>

</body>
<script type="text/html" charset="utf-8" id="chukuliangShi">
    {{each list}}
    <div class="list">
        <div id="NOinfo" class="ub sc-bg ub-pj">
            <div id="NO" class="ub ub-ver margin-t" style="margin-left:1em;">
                <div id="fyNO" class="ub ub-ac">
                    <span class="gray-font">订单号：</span>{{$value.ORDERSALE_CODE}}
                </div>
                <div id="oil" class="ub ub-ac umar-t mf-size1">
                    <div id="oilname" class="">
                        {{$value.OILINFO_NAME}}
                    </div>
                    <div id="depot" class="ub umar-a site">
                        {{if $value.EXTRACT_TYPE==1}} 自提 {{else}} 配送 {{/if}}
                    </div>

                </div>
            </div>
        </div>

        <div id="oilInfo" class="sc-bg ub ub-ver">

            <div id="stock" class="ub ub-ac order-info">
                <div id="" class="ub-f1">
                    销售单位：
                    <span class="mf-color">{{$value.xsdwName}}</span>
                </div>

            </div>
            <div id="stock" class="ub ub-ac order-info">
                <div id="" class="ub-f1">
                    订单量：
                    <span class="mf-color mf-size">{{$value.OIL_NUMBER}}</span>
                    <span class="gray-font mf-size2 umar-l">吨</span>
                </div>
                <div id="" class="ub-f1">
                    可申请数量：
                    <span class="mf-color mf-size">{{$value.noticenum-$value.outnum}}</span>
                    <span class="gray-font mf-size2 umar-l">吨</span>
                </div>
            </div>
            <div id="stock" class="ub ub-ac order-info">
                <div id="" class="ub-f1">
                    是否按出库量结算：
                    <span class="mf-color mf-size">{{$value.CHUKULIANG}}</span>
                    <span class="gray-font mf-size2 umar-l"></span>
                </div>

            </div>
            {{if $value.EXTRACT_TYPE == '0'}}
            <div class="ub ub-pe umar-r t-border padding-a">
                <span id={{$value.NOTICESUB_ID+ '#'+$value.NOTICE_CODE}} class="m-act2 mf-size2 green-bg" onclick="sendPeisong(id)">配送</span>
            </div>
            {{else if $value.EXTRACT_TYPE == '1'}}
            <div class="ub ub-pe umar-r t-border padding-a">
                <span id={{$value.NOTICESUB_ID+ '#'+$value.NOTICE_CODE}} class="m-act2 mf-size2 orange-bg" onclick="sendYue(id)">预约</span>
            </div>
            {{/if}}

        </div>
    </div>
    {{/each}}
</script>
<script type="text/html" charset="utf-8" id="chukuliangFou">
    {{each list}}
    <div class="list">
        <div id="NOinfo" class="ub sc-bg ub-pj">
            <div id="NO" class="ub ub-ver margin-t" style="margin-left:1em;">
                <div id="fyNO" class="ub ub-ac">
                    <span class="gray-font">订单号：</span>{{$value.ORDERSALE_CODE}}
                </div>
                <div id="oil" class="ub ub-ac umar-t mf-size1">
                    <div id="oilname" class="">
                        {{$value.OILINFO_NAME}}
                    </div>
                    <div id="depot" class="ub umar-a site">
                        {{if $value.EXTRACT_TYPE==1}} 自提 {{else}} 配送 {{/if}}
                    </div>

                </div>
            </div>
        </div>

        <div id="oilInfo" class="sc-bg ub ub-ver">

            <div id="stock" class="ub ub-ac order-info">
                <div id="" class="ub-f1">
                    销售单位：
                    <span class="mf-color">{{$value.xsdwName}}</span>
                </div>

            </div>
            <div id="stock" class="ub ub-ac order-info">
                <div id="" class="ub-f1">
                    订单量：
                    <span class="mf-color mf-size">{{$value.OIL_NUMBER}}</span>
                    <span class="gray-font mf-size2 umar-l">吨</span>
                </div>
                <div id="" class="ub-f1">
                    可申请数量：
                    <span class="mf-color mf-size">{{if $value.outnum}}{{$value.noticenum-$value.outnum}} {{else}}{{$value.noticenum}}{{/if}}</span>
                    <span
                        class="gray-font mf-size2 umar-l">吨</span>
                </div>
            </div>
            <div id="stock" class="ub ub-ac order-info">
                <div id="" class="ub-f1">
                    是否按出库量结算：
                    <span class="mf-color mf-size">{{$value.CHUKULIANG}}</span>
                    <span class="gray-font mf-size2 umar-l"></span>
                </div>

            </div>
            {{if $value.EXTRACT_TYPE == '0'}}
            <div class="ub ub-pe umar-r t-border padding-a">
                <span id={{$value.NOTICESUB_ID+ '#'+$value.NOTICE_CODE}} class="m-act2 mf-size2 green-bg" onclick="sendPeisong(id)">配送</span>
            </div>
            {{else if $value.EXTRACT_TYPE == '1'}}
            <div class="ub ub-pe umar-r t-border padding-a">
                <span id={{$value.NOTICESUB_ID+ '#'+$value.NOTICE_CODE}} class="m-act2 mf-size2 orange-bg" onclick="sendYue(id)">预约</span>
            </div>
            {{/if}}

        </div>
    </div>
    {{/each}}
</script>
<script src="../build/js/appcan.js"></script>
<script src="../build/js/appcan.control.js"></script>
<script src="../common/template-web.js" type="text/javascript" charset="utf-8"></script>
<script src="../common/comm.js"></script>

</body>
<script>
    appcan.ready(function () {
        mentionOil.init();
    })
    var mentionOil = {
        init: function () {
            var yue = this;
            yue.queryMentOilOrder();
        },
        queryMentOilOrder: function () {
            var yue = this;
            var func = yue.showOrderCallback.bind(yue);
            var orderId = appcan.locStorage.getVal("orderId");
            var paramJsonStr = "orderId=" + orderId;

            ajaxPostQuery(URL + "/app/billSend/getOilExtractionList", paramJsonStr, func, "text");
            appcan.window.openToast('加载中...', '0', '5', '1');
        },
        showOrderCallback: function (data) {
            appcan.window.closeToast();
            var data = JSON.parse(data);
            var ahtml = null;
            if (data.chukuliang == "否") {
                ahtml = template('chukuliangFou', {
                    list: data.list
                });
            }
            if (data.chukuliang != "否") {
                ahtml = template('chukuliangShi', {
                    list: data.list
                });
            }

            document.getElementById('content').innerHTML = ahtml;
        }
    }


    // 按出库量结算
    // 配送
    function sendPeisong(value) {

        var arr = value.split('#');
        var noticeSubId = arr[0];
        var noticeCode = arr[1];

        appcan.locStorage.setVal("yuyuenoticeId", noticeSubId);
        appcan.window.open("delivery", "delivery.html", 10);
    }

    // 预约自提
    function sendYue(value) {
        var arr = value.split('#');
        var noticeSubId = arr[0];
        var noticeCode = arr[1];
        appcan.locStorage.setVal("yuyuenoticeId", noticeSubId);
        appcan.window.open("zitiPage", "zitipage.html", 10);

    }
</script>

</html>