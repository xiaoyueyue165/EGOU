<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">

<head>
	<title></title>
	<meta charset="utf-8" />
	<meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
	/>
	<link rel="stylesheet" href="../build/css/fonts/font-awesome.min.css" />
	<link rel="stylesheet" href="../build/css/ui-box.css" />
	<link rel="stylesheet" href="../build/css/ui-base.css" />
	<link rel="stylesheet" href="../build/css/ui-color.css" />
	<link rel="stylesheet" href="../build/css/appcan.icon.css" />
	<link rel="stylesheet" href="../build/css/appcan.control.css" />
	<link rel="stylesheet" type="text/css" href="css/quickbuy.css" />
	<link rel="stylesheet" type="text/css" href="../common/css/yue.css" />
	<style type="text/css">
		table {
			width: 100%;
		}

		td {
			width: 50%;
			padding: 0.2em;
			text-align: center;
		}

		.border-transparent {
			border: 0.1em solid transparent;
		}

		.por,
		.por {
			position: relative;
		}

		.pos {
			position: absolute;
			margin-left: 0.2em;
		}

		.dun:after {
			content: '吨';
		}

		.yuan:after {
			content: '元';
		}

		.pop-body {
			height: 100%;
			position: fixed;
			width: 100%;
			z-index: 8;
			background: rgba(0, 0, 0, 0.5) !important
		}

		form {
			padding: 1em 0.5em 0;
		}
	</style>
</head>

<body class="um-vp " ontouchstart="">
	<div id="pop" class="">
	</div>
	<div id="content" class="ub-f1 tx-l" style="height:100%">
		<div id="loginlabel" class="float-bar-wrapper clearfix">
			<div class="ub ub-pj float-bar">
				<div id="isLogin" class="umar-l mf-size2" onclick="gotoLoginPage()">
					马上登录购油
				</div>
			</div>
		</div>
		<div id="oilDataList" class="clearfix">
		</div>
		<!-- 购油弹出框 -->
		<div class="wrapper pop-window" style="top:47% !important;">
			<input type="hidden" id="biaoshi" name="biaoshi" />
			<form action="" id="myFormId" class="judge-form">
				<table>
					<tbody>
						<tr>
							<td>油品型号：</td>
							<td id="oilName"></td>
						</tr>
						<tr>
							<td>油品数量：</td>
							<td class="por">
								<div class="dun">
									<input class="m-input" type="text" name="num" id="num" value="1" style="text-align: left; " onblur="panduanNum(this)" />
								</div>
							</td>
						</tr>
						<tr>
							<td>油品价格：</td>
							<td class="por">
								<div class="yuan">
									<input id="shangxian" type="hidden" value="" />
									<input id="xiaxian" type="hidden" value="" />
									<input id="oilPrice" class="m-input" type="text" name="oilPrice" value="" style="text-align: left;" onblur="panduanJiage(this)"
									/>
								</div>
							</td>
						</tr>
						<tr>
							<td>提油方式：</td>
							<td>
								<select id="psfs" name="psfs" class="mySelect" style="font-size:1em;" onchange="change();"> </select>
								<span style="visibility:hidden">吨</span>
							</td>
						</tr>
						<tr>
							<td>运输方式：</td>
							<td>
								<select id="ysfs" name="ysfs" class="mySelect ellipsis" style="font-size:1em;"> </select>
								<span style="visibility:hidden">吨</span>
							</td>
						</tr>
						<tr>
							<td>销售单位：</td>
							<td>
								<select id="gyfgs" name="gyfgs" class="mySelect ellipsis" style="font-size:1em;"> </select>
								<span style="visibility:hidden">吨</span>
							</td>
						</tr>
						<tr>
							<td>油库地点：</td>
							<td>
								<select id="ykdd" name="ykdd" class="mySelect" style="font-size:1em;"> </select>
								<span style="visibility:hidden">吨</span>
							</td>
						</tr>
					</tbody>
				</table>
				<div class="margin-t-2x">
					<div class="checkbox umar-r um3">
						<input id="chukuliang" type="checkbox" class="uabs ub-con" />
					</div>
					<span class="chuku">按出库量结算</span>
				</div>
				<div class="margin-t-2x">
					<div class="checkbox umar-r um3">
						<input id="youhui" type="checkbox" onchange="youhuiChange()" class="uabs ub-con" />
					</div>
					<span class="chuku">减免运费</span>
				</div>
				<div id="btn" class="ub ub-ac">
					<div id="confirmBtn" class="uinn5 ubt ubr bc-border ub ub-f1 ub-pc">
						<span class="mf-color" onclick="shopping()">确认</span>
					</div>
					<div id="cancelBtn" class="uinn5 ubt bc-border ub ub-f1 ub-pc">
						<span class="mf-color" onclick="cancel()">关闭</span>
					</div>
				</div>
			</form>
		</div>
	</div>
	<script src="../build/js/appcan.js"></script>
	<script src="../build/js/appcan.control.js"></script>
	<script src="../build/js/appcan.listview.js"></script>
	<script type="text/javascript" src="../common/comm.js"></script>
	<script type="text/javascript" charset="utf-8" src="../common/template-web.js"></script>
	<script type="text/javascript" src="../common/jquery.min.js" charset="utf-8"></script>
	<script src="../common/axios.js"></script>
	<script id="checkcity" type="text/html">

		{{each list}}
		<option value={{$value.basOrgId}}>{{$value.orgName}}</option>
		{{/each}}

	</script>
	<script id="checkoil" type="text/html" charset="utf-8">
		{{each list as value i}} {{if value.depotName== '海滨油库'}}
		<option selected="selected" value={{value.oildepotId}}>{{value.depotName}}</option>
		{{else}}
		<option value={{value.oildepotId}}>{{value.depotName}}</option>
		{{/if}} {{/each}}
	</script>
	<script id="checkYsfs" type="text/html">

		{{each list}}
		<option value={{$value.dicId}}>{{$value.dicName}}</option>
		{{/each}}

	</script>
	<script>
		var oilNumber,
			oilRealPrice,
			ykdd,
			fangshi = "0",
			yuanshiPrice = 0,
			hetongId = "", //合同文件ID
			shengyu = "", //合同文件剩余量
			biaoshi = "", //控股公司、普通客户、并表站
			cusId = "";
		appcan.ready(function () {

			appcan.window.subscribe("listPageRefresh", function (param) {
				if (param == "true") {
					$("#loginlabel").html("");
					$("#oilDataList").html("");
					showOilList();
				}
			})
			appcan.window.subscribe("userForCompany", function (data) {
				if (data === '0') {
					window.location.reload();
				}
			});
			showOilList();
		});

		// 渲染油品列表
		function showOilList() {
			var username = appcan.locStorage.getVal("username");
			if (username) {
				$('#isLogin').html('正在登录...')
			}

			var url = URL + "/app/oil/queryOilPriceList";
			var paramJsonStr = "limit=" + limit + "&offset=" + offset;
			var func = showOilDetailCallback;
			var dataType = "text";
			ajaxPostQueryDNnotVerifySid(url, paramJsonStr, func, dataType);
			appcan.window.openToast('加载中...', '0', '5', '1');
			appcan.initBounce();
		}

		function showOilDetailCallback(data) {
			appcan.window.closeToast();
			if (typeof data == "string") {
				var data = JSON.parse(data);
			}
			var pojoList = data.pojoList,
				loginName = data.loginName,
				cusCompany = appcan.locStorage.getVal('cusCompany'),
				listData = [],
				username = appcan.locStorage.getVal('username');
			if (username) {
				// 未登录用户
				var nameStr = cusCompany ? cusCompany : loginName;
				$('#isLogin').html('<span class="mf-size1 umar-r">' + nameStr + '</span>已登录')
			}

			// 循环遍历
			for (var i = 0; i < pojoList.length; i++) {

				//油品ID
				var oilinfoId = pojoList[i].oilinfoId,
					//油品名称
					oilinfoName = pojoList[i].oilinfoName,
					// 油品短名称
					oilinfoNameShort = oilinfoName,
					//价格展示
					pcDiscount = pojoList[i].pcDiscount ? fmoney(pojoList[i].pcDiscount, 2) : "￥暂无价格",
					//自提优惠价格
					pickupDiscount = pojoList[i].pickupDiscount;
				// 展示油品
				marketPrice = pojoList[i].marketPrice;

				if (pcDiscount != "￥暂无价格" && pcDiscount != 0) {
					pcDiscount = '￥' + pcDiscount + '/吨'
				}

				if (pcDiscount == "￥暂无价格") {
					continue;
				}

				var oilInfoparam = "&quot;" + oilinfoId + "&quot;,&quot;" + pcDiscount + "&quot;,&quot;" + pickupDiscount +
					"&quot;,&quot;" + oilinfoName + "&quot";

				var htmlstr = "",
					addOrderStr = "",
					baseInfo = "";
				if (pcDiscount == 0 || pcDiscount == "￥暂无价格") {
					baseInfo = "<span class='title'>" + oilinfoName + "</span></div>";
				} else {
					// 加入意向单控制
					baseInfo = "<span class='title'>" + oilinfoNameShort + "</span></div>";
					if (!marketPrice && username) {
						addOrderStr = "<div class='uc-a3 border-transparent uinn2 padding-l2 mf-size2  gray'>&nbsp;&nbsp;&nbsp;</div>";
					} else {
						addOrderStr = "<div class='uc-a3 a-border2 uinn2 padding-l2 mf-size2 btn-cart-add-gray gray' onclick='showToast(" +
							oilInfoparam + ");'>加入意向单</div>";
					}

				}

				htmlstr += "<div class='item-wrapper'>" + "<div class='ub ub-ver ub-ac item-content'>" +
					"<div id='name' class='ub ub-pc t-section mf-color2' value='" + oilinfoId + "'>" + baseInfo;

				htmlstr += "<div id='price' class='ub ub-pc uc-a3 c-block' value='" + oilInfoparam + "'>" + pcDiscount + "</div>";

				htmlstr += "<div id='add' class='action-add'>" + addOrderStr + "</div></div></div>";

				$("#oilDataList").css("opacity", "0");
				$("#oilDataList").append(htmlstr);
				$("#oilDataList").animate({
					opacity: 1
				}, 500);
			}
			var height = document.querySelector('.item-wrapper').clientHeight + 'px';
			console.dir(document.querySelector('.item-wrapper'))

			var box = '<div style="height:' + height + ';width:100%;float:left;"> &nbsp</div>';
			$("#oilDataList").append(box);

		}
		// 获取详情，销售单位、油库列表
		function showOilInfo() {

			var func = showOilInfoCallback;
			ajaxPostQuery(URL + "/app/oil/buyOilInfoList", "", func, "text");
			appcan.window.openToast('加载中...', '0', '5', '1');
			appcan.initBounce();
		}

		function showOilInfoCallback(data) {
			appcan.window.closeToast();
			var data = JSON.parse(data);
			var companyList = data.companyList;
			var html = template('checkcity', {
				list: companyList
			})

			$("#gyfgs").html(html);
			var oildepotList = data.oildepotList;
			var html1 = template('checkoil', {
				list: oildepotList
			})

			$("#ykdd").html(html1);
			var tongshengText = appcan.locStorage.getVal("cusCompany");
			if (tongshengText == "上海中油同盛石油有限公司") {

				$("#ykdd").append(
					"<option value='1234567890' selected='selected'>同盛水上库</option><option value='0987654321' selected='selected'>同盛油罐车</option>"
				);
			}
			var ysfsList = data.ysfsList;
			var html2 = template('checkYsfs', {
				list: ysfsList
			})

			$("#ysfs").html(html2);

		}

		// 物件文件调整价格
		function getWujiaWenJia(oilPrice, oilinfoId) {

			var tyfstext;
			var ysfstext;
			var xsdwtext;

			var oilPrice = rmoney(oilPrice.slice(1, -2));

			// 配送费方式 首次获取失败
			var tiyou = document.getElementById("psfs");
			for (i = 0; i < tiyou.length; i++) { //下拉框的长度就是它的选项数.
				if (tiyou[i].selected == true) {
					tyfstext = tiyou[i].text;
					//获取当前选择项的值.
					break;
				}
			}
			// 运输方式
			var ysfs = document.getElementById("checkYsfs");
			for (i = 0; i < ysfs.length; i++) { //下拉框的长度就是它的选项数.
				if (ysfs[i].selected == true) {
					ysfstext = ysfs[i].text;
					//获取当前选择项的值.
					break;
				}
			}
			if (ysfstext == undefined) {
				ysfstext = "公路";
			}
			// 购油分公司
			// xsdw 获取失败
			var xsdw = document.getElementById("gyfgs");
			for (i = 0; i < xsdw.length; i++) { //下拉框的长度就是它的选项数.
				if (xsdw[i].selected == true) {
					xsdwtext = xsdw[i].value;
					//获取当前选择项的值.
					break;
				}
			}

			var sid = appcan.locStorage.getVal('sid');

			var paramJsonStr = "oilPrice=" + oilPrice + "&ysfs=" + ysfstext + "&tyfs=" + tyfstext + "&xsdw=" + xsdwtext +
				"&oilinfoId=" + oilinfoId + "&sid=" + sid;
			$.ajax({
				url: URL + "/front/oilPrice/object/queryObjectPriceByOilId",
				type: "post",
				data: paramJsonStr,
				success: function (data) {
					var modelList = JSON.parse(data),
						price = modelList.price || 0,
						fprice = fmoney(price);
					appcan.locStorage.setVal('wjPrice', price);


					biaoshi = modelList.biaoshi;
					document.getElementById("biaoshi").value = biaoshi;

					//控股公司买油时，价格不可修改，普通客户购油价格可修改
					if (modelList.biaoshi == "并表站") {
						document.getElementById("oilPrice").value = "";
						document.getElementById("oilPrice").readOnly = "readonly";
					} else {
						yuanshiPrice = modelList.price;
						document.getElementById("oilPrice").value = fprice;

						// 上限，下限
						$("#shangxian").val(modelList.shangxian);
						$("#xiaxian").val(modelList.xiaxian);

						if (modelList.biaoshi == "控股") {
							if (modelList.szhyCode == "91310115671102008B") { //中油临港当做并表站处理
								$("#oilPrice").val("");
								document.getElementById("oilPrice").readOnly = "readonly";
							} else {
								document.getElementById("oilPrice").readOnly = "readonly";
							}
						}
					}
					hetongId = modelList.hetongId;
					shengyu = modelList.shengyu;
					//上海中油上中油气站有限公司、上海中油高盈工贸有限公司特殊处理
					//alert(modelList.cusId);
					cusId = modelList.cusId;
					if (modelList.cusId == "100320C7748740D4AF6A56726C4E9040" || modelList.cusId ==
						"100320C7748740D4AF6A56726C4E9075") {
						yuanshiPrice = modelList.price;
						$("#oilPrice").val(modelList.price);

						document.getElementById("oilPrice").removeAttribute("readonly");
					}
					youhuiChange();

				}
			});

		}

		//弹出框
		function showToast(oilinfoId, oilPrice, pickupDiscount, oilinfoName) {

			//存储变量
			lsSetItems({
				"oilinfoIdOne": oilinfoId,
				"oilPriceOne": oilPrice,
				"pickupDiscount": pickupDiscount,
				"oilinfoNameOne": oilinfoName
			})

			//登录验证
			var username = appcan.locStorage.getVal("username");

			if (!username) {

				appcan.window.alert({
					title: "提示",
					content: "请先登录再进行购油",
					buttons: ['确定', '取消'],
					callback: function (err, data, dataType, optId) {
						if (data == '0') {
							appcan.locStorage.setVal("tag", "listpage");
							appcan.window.open("login", "../userpage/login.html", 10);
						}
						if (data == '1') {

						}
						console.log(err, data, dataType, optId);
					}
				});

				return;

			}

			// 获取油品详情
			showOilInfo();

			$(".wrapper")[0].style.display = 'block';
			$("#pop")[0].className = "pop-body";

			// 显示配送方式
			var options = '<option id="peisong" value="0">配送</option>' + '<option id="ziti" value="1">自提</option>';
			document.getElementById('psfs').innerHTML = options;

			// 物价文件调整价格
			getWujiaWenJia(oilPrice, oilinfoId);
			//显示
			$('#oilName').html(oilinfoName);

			//三个接口
			/*
			 axios.all([queryOildepot(), queryYsfs(), queryCompany()]).then(axios.spread(function(acct, perms) {
	
			 $(".wrapper")[0].style.display = 'block';
			 $("#pop")[0].className = "pop-body";
			 document.getElementById('psfs').innerHTML = options;
			 // 鐗╀环鏂囦欢璋冩暣浠锋牸
			 getWujiaWenJia(oilPrice, oilinfoId);
			 //鏄剧ず
			 $('#oilName').html(oilinfoName);
			 }));
			 */

		}

		//自提配送切换 0配送1自提
		function change() {
			var myselect = document.getElementById("psfs");
			nowIndex = myselect.selectedIndex,
				nowValue = myselect.options[nowIndex].value,
				//弹出框油品价格
				oilRealPrice = rmoney($('#oilPrice').val()),
				//自提优惠
				pickupDiscount = appcan.locStorage.getVal('pickupDiscount')
			// 真实的物价文件价格
			wjPrice = appcan.locStorage.getVal('wjPrice');

			if (nowIndex == '0') {
				//配送
				fangshi = 0;
				$('#oilPrice').val(fmoney(wjPrice));
			} else {
				fangshi = '1';
				oilPrice = Number(oilRealPrice) - Number(pickupDiscount);
				$('#oilPrice').val(fmoney(oilPrice));
			}

		}

		//加入购物车,弹出框点击确定
		function shopping() {

			//验证通过,先验证价格

			oilNumber = $('#num').val();
			oilRealPrice = $('#oilPrice').val();

			if (device == "iPhone") {
				document.getElementById('num').removeAttribute("onblur");
				document.getElementById('oilPrice').removeAttribute("onblur");

				var Toast = function () {
					appcan.window.alert({
						title: "提示",
						content: "购油数量最小为0.001吨,不能大于500吨！",
						buttons: ['确定'],
						callback: function (err, data, dataType, optId) {
							console.log(err, data, dataType, optId);
						}
					});
					document.getElementById("num").value = 1;
				}
				if (parseFloat(oilNumber) > 500 || parseFloat(oilNumber) < 0.001) {
					Toast();
					return;
				}

				var shang = $("#shangxian").val();
				var xia = $("#xiaxian").val();
				nowPrice = oilRealPrice;
				if (nowPrice.indexOf(',') != -1) {
					nowPrice = rmoney(nowPrice);
				}

				if (parseFloat(nowPrice) > parseFloat(shang) || parseFloat(nowPrice) < parseFloat(xia)) {
					appcan.window.alert({
						title: "提示",
						content: "超过上下限价格，请重新输入！<上限：" + shang + "，下限：" + xia + ">",
						buttons: ['确定'],
						callback: function (err, data, dataType, optId) {
							console.log(err, data, dataType, optId);
						}
					});
					document.getElementById("oilPrice").value = fmoney(yuanshiPrice);
					return;
				}
			}

			var oilinfoId = appcan.locStorage.getVal("oilinfoIdOne");
			var paramJsonStr = "oilinfoId=" + oilinfoId;

			var url = URL + "/front/bill/checkPriceStrategy";
			var dataType = "text";
			var func = afterPriceStrategyAdd;

			ajaxPostQuery(url, paramJsonStr, func, dataType);



			//先关闭提交页面
			$(".wrapper")[0].style.display = 'none';
			$('#pop')[0].className = "";

			appcan.window.alert({
				title: "请注意",
				content: "油品已加入到您的意向单",
				buttons: ['继续购油', '查看意向单'],
				callback: function (err, data, dataType, optId) {
					if (data == '1') {
						//购油编辑页面跳转1
						appcan.window.open("register", "intentionList/intentionList.html", 10);
					}
					if (data == '0') {
						console.log('关闭弹窗')
					}
				}
			});
		}

		//比价回调,插入意向单
		function afterPriceStrategyAdd(data) {
			oilNumber = $('#num').val();
			oilPrice = document.getElementById("oilPrice").value;
			oilRealPrice = oilPrice ? rmoney(oilPrice) : '';
			var biaoshi = document.getElementById("biaoshi").value;
			ykdd = $('#ykdd').val()
			var chukuliang = "",
				youhui = null;
			if (document.getElementById("chukuliang").checked) {
				chukuliang = "是";
			} else {
				chukuliang = "否";
			}
			if (document.getElementById("youhui").checked) {
				youhui = "是";
			} else {
				youhui = "否";
			}
			// alert(chukuliang)
			if (typeof data == "string") {
				var data = JSON.parse(data);

			}
			if (Number(data.price) > Number($('#oilPrice').val())) {
				alert("请根据价格策略填写价格！")
			} else {

				//插入意向单
				var oilinfoId = appcan.locStorage.getVal("oilinfoIdOne"),
					//油品id
					oilinfoName = decodeURI(appcan.locStorage.getVal("oilinfoNameOne")),

					paramJsonStr = "oilinfoId=" + oilinfoId + "&oilPrice=" + oilRealPrice + "&oilNumber=" + oilNumber +
					"&extractType=" + fangshi + "&oilinfoName=" + oilinfoName + "&ysfs=" + $('#ysfs').val() + "&chukuliang=" +
					chukuliang + "&ykdd=" + ykdd + "&gyfgs=" + $('#gyfgs').val() + "&youhui=" + youhui + "&hetongId=" + hetongId,
					dataType = "text",
					func =
					afterAdd;

				if (biaoshi === "并表站") {
					//上海中油上中油气站有限公司、上海中油高盈工贸有限公司特殊处理
					// 加油站买油
					if (cusId == "100320C7748740D4AF6A56726C4E9040" || cusId == "100320C7748740D4AF6A56726C4E9075") {
						var url = URL + "/front/bill/insertBill";

						appcan.window.openToast('正在提交表单...', '0', '5', '1');
						ajaxPostQuery(url, paramJsonStr, func, dataType);
						return;
					} else {
						var url = URL + "/front/bill/insertBillJiaYouZhan";
						appcan.window.openToast('正在提交表单...', '0', '5', '1');
						ajaxPostQuery(url, paramJsonStr, func, dataType);
					}
				} else {

					var url = URL + "/front/bill/insertBill";
					appcan.window.openToast('正在提交表单...', '0', '5', '1');
					ajaxPostQuery(url, paramJsonStr, func, dataType);
				}
			}
		}

		/* 	var queryOptions = {
				company: '/app/bill/checkCompany',
				oildepot: '/front/oildepot/selectXiaLaOildepot',
				ysfs: '/front/oildepot/selectXiaLaOildepot'
			} */
		// queryUseOptions('company', queryOptions.company)
		/* 		function queryUseOptions(type, str) {
		
					var url = URL + str,
						sid = appcan.locStorage.getVal("sid");
					paramJsonStr = "sid=" + sid;
		
					$.ajax({
						type: 'post',
						url: url,
						cache: true,
						data: paramJsonStr,
						success: function (data) {
		
							if (typeof data == "string") {
								data = JSON.parse(data);
							}
							switch (type) {
								// 所属公司列表
								case "company":
									var html = template('checkcity', {
										list: data
									})
		
									$("#gyfgs").html(html);
									break;
								//油库列表
								case "oildepot":
									var html = template('checkoil', {
										list: data
									})
		
									$("#ykdd").html(html);
									break;
								// 运输方式
								case "ysfs":
									var html = template('checkYsfs', {
										list: data
									})
		
									$("#ysfs").html(html);
									break;
		
								default:
									break;
							}
		
		
						}
					})
				} */
		function youhuiChange() {
			var youhui = "";
			document.getElementById("youhui").checked ? youhui = "是" : youhui = "否";

			if (youhui == "是" && fangshi == "0") {
				var oilRealPrice = $('#oilPrice').val();

				if (biaoshi != "并表站") {
					var nowPrice = fmoney(yuanshiPrice - 30);
					$('#oilPrice').val(nowPrice);
				}
			} else if (biaoshi == "并表站") {
				$('#oilPrice').val(fmoney(0));
			} else {
				$('#oilPrice').val(fmoney(yuanshiPrice));
			}

		}


		function panduanJiage(that) {
			var shang = $("#shangxian").val();
			var xia = $("#xiaxian").val();
			nowPrice = that.value;
			var yuanshi = nowPrice;
			if (nowPrice.indexOf(',') != -1) {
				nowPrice = rmoney(nowPrice);
			}
			if (parseFloat(nowPrice) > parseFloat(shang) || parseFloat(nowPrice) < parseFloat(xia)) {
				alert("超过上下限价格，请重新输入！<上限：" + shang + "，下限：" + xia + ">");
				document.getElementById("oilPrice").value = fmoney(yuanshiPrice);
				return;
			}
		}

		function panduanNum(that) {
			var num = that.value;

			if (biaoshi == "普通") {
				if (parseFloat(num) > 500 || parseFloat(num) < 0.01) {
					appcan.window.alert({
						title: "提示",
						content: "购油数量最小为0.001吨,不能大于500吨！",
						buttons: ['确定'],
						callback: function (err, data, dataType, optId) {
							console.log(err, data, dataType, optId);
						}
					});
					document.getElementById("num").value = 1;
					return;
				}

			}
		}
		//插入成功
		function afterAdd(data) {
			appcan.window.closeToast();
			if (typeof data == "string") {
				data = JSON.parse(data)
			}
		}

		function cancel() {

			$(".wrapper")[0].style.display = 'none';
			$('#pop')[0].className = "";

		}

		//未登录用户，去登录
		function gotoLoginPage() {
			appcan.locStorage.setVal("tag", "listpage");
			appcan.window.open("login", "../userpage/login.html", 10);
		}


		appcan.button("#nav-left", "btn-act", function () {
			appcan.window.close(-1);
		});
	</script>
</body>

</html>